This repository contains three [AnimUML](https://github.com/fjouault/AnimUML) model variants of a simple vulnerable device driver:
* [with a simple valid device](https://animuml.kher.nl/AnimUML.html#{"name":"VulnerableDriver","objects":[{"name":"device","isActor":true,"stateByName":{"init":{"type":"Pseudostate","kind":"initial"},"Idle":{"internalTransitions":{"ok":{"trigger":"askData","effect":"console.log(%5C"Writing%20consistent%20data.%5C");%20driver.write(3);%20driver.write(2);%5Cndriver.write(1);%20driver.write(0x55);%20driver.write(2);%20driver.write(0x4D);%20driver.write(0x4C);"}}}},"transitionByName":{"init2Idle":{"source":"init","target":"Idle"}}},{"name":"driver","stateByName":{"init":{"type":"Pseudostate","kind":"initial"},"choice1":{"type":"Pseudostate","kind":"choice"},"choice":{"type":"Pseudostate","kind":"choice"},"Idle":{"entry":"this.packetSize%20=%200;"}},"transitionByName":{"init2Idle":{"source":"init","target":"Idle","effect":"this.packetNumber%20=%200;"},"Idle2WaitSize":{"source":"Idle","target":"WaitSize","trigger":"after(10ms)","guard":"EP_IS_EMPTY(memoryBlock)%20&&%20!IS_IN_STATE(memoryBlock,%20memoryBlock.Error)","effect":"device.askData();"},"WaitSize2WaitPacketNumber":{"source":"WaitSize","target":"WaitPacketNumber","trigger":"write(byte)","effect":"memoryBlock.malloc(byte);%20this.offset%20=%200;"},"WaitPacketNumber2choice1":{"source":"WaitPacketNumber","target":"choice1","trigger":"write(byte)","guard":"EP_IS_EMPTY(memoryBlock)","effect":"%5Cnthis.packetNumber%20=%20byte;"},"choice12Idle":{"source":"choice1","target":"Idle","guard":"else","effect":"%5Cnconsole.log('process%20data');%5CnmemoryBlock.free();"},"choice12WaitPacketSize":{"source":"choice1","target":"WaitPacketSize","guard":"this.packetNumber%20>%200"},"WaitPacketSize2ReceiveData":{"source":"WaitPacketSize","target":"ReceiveData","trigger":"write(byte)","guard":"EP_IS_EMPTY(memoryBlock)","effect":"%5Cnthis.packetSize%20=%20byte;"},"ReceiveData2choice":{"source":"ReceiveData","target":"choice","trigger":"write(byte)","guard":"EP_IS_EMPTY(memoryBlock)","effect":"%5CnmemoryBlock.set(offset,%20byte);%5Cnthis.offset++;%20this.packetSize--;"},"choice2ReceiveData":{"source":"choice","target":"ReceiveData","guard":"this.packetSize%20>%200"},"choice2choice1":{"source":"choice","target":"choice1","guard":"else","effect":"%5Cnthis.packetNumber--;"}}},{"name":"memoryBlock","stateByName":{"init":{"type":"Pseudostate","kind":"initial"},"choice":{"type":"Pseudostate","kind":"choice"},"Error":{"entry":"console.log('Error%20found!')","internalTransitions":{"malloc":{"trigger":"malloc"},"set":{"trigger":"set"},"free":{"trigger":"free"}}}},"transitionByName":{"init2Free":{"source":"init","target":"Free","effect":"this.size%20=%200;"},"Free2Allocated":{"source":"Free","target":"Allocated","trigger":"malloc(size)","effect":"this.size%20=%20size;"},"Free2Error":{"source":"Free","target":"Error","trigger":"set(offset,%20value)","effect":"this.errorMessage%20=%20'use%20after%20free%20(or%20without%20allocating)';"},"Allocated2Free":{"source":"Allocated","target":"Free","trigger":"free()","effect":"this.size%20=%200;"},"Allocated2choice":{"source":"Allocated","target":"choice","trigger":"set(offset,%20value)"},"choice2Allocated":{"source":"choice","target":"Allocated","guard":"offset%20>=%200%20&&%20offset%20<%20size"},"choice2Error":{"source":"choice","target":"Error","guard":"else","effect":"this.errorMessage%20=%20'out%20of%20bounds%20write';"}}}],"connectorByName":{"C1":{"ends":["device","driver"],"possibleMessages":{"forward":["write"],"reverse":["askData"]}},"C2":{"ends":["driver","memoryBlock"],"possibleMessages":{"forward":["malloc","set","free"]}}},"settings":{"semantics":{"keepOneMessagePerTrigger":false,"fireInitialTransitions":true,"autoFireAfterChoice":true,"reactiveSystem":true,"enableEventPools":true,"matchFirst":true,"checkEvents":true},"defaultToolValues":{"VERIFY_LTL_PROPERTY.property":"prop%20=%20[]%20!%20|IS_IN_STATE(memoryBlock,%20memoryBlock.Error)|","VERIFY_LTL_SAFETY_PROPERTY.property":"prop%20=%20[]%20!%20|IS_IN_STATE(memoryBlock,%20memoryBlock.Error)|"}}}) that generates a valid message
* [with a simple invalid device](https://animuml.kher.nl/AnimUML.html#{"name":"VulnerableDriver","objects":[{"name":"device","isActor":true,"stateByName":{"init":{"type":"Pseudostate","kind":"initial"},"Idle":{"internalTransitions":{"shellCode":{"trigger":"askData","effect":"console.log(%5C"Writing%20inconsistent%20data%5C");%20driver.write(1);%20driver.write(1);%5Cndriver.write(9);%20driver.write(0x53);%20driver.write(0x48);%20driver.write(0x45);%20driver.write(0x4C);%5Cndriver.write(0x4C);%20driver.write(0x43);%20driver.write(0x4F);%20driver.write(0x44);%20driver.write(0x45);"}}}},"transitionByName":{"init2Idle":{"source":"init","target":"Idle"}}},{"name":"driver","stateByName":{"init":{"type":"Pseudostate","kind":"initial"},"choice1":{"type":"Pseudostate","kind":"choice"},"choice":{"type":"Pseudostate","kind":"choice"},"Idle":{"entry":"this.packetSize%20=%200;"}},"transitionByName":{"init2Idle":{"source":"init","target":"Idle","effect":"this.packetNumber%20=%200;"},"Idle2WaitSize":{"source":"Idle","target":"WaitSize","trigger":"after(10ms)","guard":"EP_IS_EMPTY(memoryBlock)%20&&%20!IS_IN_STATE(memoryBlock,%20memoryBlock.Error)","effect":"device.askData();"},"WaitSize2WaitPacketNumber":{"source":"WaitSize","target":"WaitPacketNumber","trigger":"write(byte)","effect":"memoryBlock.malloc(byte);%20this.offset%20=%200;"},"WaitPacketNumber2choice1":{"source":"WaitPacketNumber","target":"choice1","trigger":"write(byte)","guard":"EP_IS_EMPTY(memoryBlock)","effect":"%5Cnthis.packetNumber%20=%20byte;"},"choice12Idle":{"source":"choice1","target":"Idle","guard":"else","effect":"%5Cnconsole.log('process%20data');%5CnmemoryBlock.free();"},"choice12WaitPacketSize":{"source":"choice1","target":"WaitPacketSize","guard":"this.packetNumber%20>%200"},"WaitPacketSize2ReceiveData":{"source":"WaitPacketSize","target":"ReceiveData","trigger":"write(byte)","guard":"EP_IS_EMPTY(memoryBlock)","effect":"%5Cnthis.packetSize%20=%20byte;"},"ReceiveData2choice":{"source":"ReceiveData","target":"choice","trigger":"write(byte)","guard":"EP_IS_EMPTY(memoryBlock)","effect":"%5CnmemoryBlock.set(offset,%20byte);%5Cnthis.offset++;%20this.packetSize--;"},"choice2ReceiveData":{"source":"choice","target":"ReceiveData","guard":"this.packetSize%20>%200"},"choice2choice1":{"source":"choice","target":"choice1","guard":"else","effect":"%5Cnthis.packetNumber--;"}}},{"name":"memoryBlock","stateByName":{"init":{"type":"Pseudostate","kind":"initial"},"choice":{"type":"Pseudostate","kind":"choice"},"Error":{"entry":"console.log('Error%20found!')","internalTransitions":{"malloc":{"trigger":"malloc"},"set":{"trigger":"set"},"free":{"trigger":"free"}}}},"transitionByName":{"init2Free":{"source":"init","target":"Free","effect":"this.size%20=%200;"},"Free2Allocated":{"source":"Free","target":"Allocated","trigger":"malloc(size)","effect":"this.size%20=%20size;"},"Free2Error":{"source":"Free","target":"Error","trigger":"set(offset,%20value)","effect":"this.errorMessage%20=%20'use%20after%20free%20(or%20without%20allocating)';"},"Allocated2Free":{"source":"Allocated","target":"Free","trigger":"free()","effect":"this.size%20=%200;"},"Allocated2choice":{"source":"Allocated","target":"choice","trigger":"set(offset,%20value)"},"choice2Allocated":{"source":"choice","target":"Allocated","guard":"offset%20>=%200%20&&%20offset%20<%20size"},"choice2Error":{"source":"choice","target":"Error","guard":"else","effect":"this.errorMessage%20=%20'out%20of%20bounds%20write';"}}}],"connectorByName":{"C1":{"ends":["device","driver"],"possibleMessages":{"forward":["write"],"reverse":["askData"]}},"C2":{"ends":["driver","memoryBlock"],"possibleMessages":{"forward":["malloc","set","free"]}}},"settings":{"semantics":{"keepOneMessagePerTrigger":false,"fireInitialTransitions":true,"autoFireAfterChoice":true,"reactiveSystem":true,"enableEventPools":true,"matchFirst":true,"checkEvents":true},"defaultToolValues":{"VERIFY_LTL_PROPERTY.property":"prop%20=%20[]%20!%20|IS_IN_STATE(memoryBlock,%20memoryBlock.Error)|","VERIFY_LTL_SAFETY_PROPERTY.property":"prop%20=%20[]%20!%20|IS_IN_STATE(memoryBlock,%20memoryBlock.Error)|"}}}) that generates an invalid message
* [with a generic device](https://animuml.kher.nl/AnimUML.html#{"name":"VulnerableDriver","objects":[{"name":"device","isActor":true,"stateByName":{"init":{"type":"Pseudostate","kind":"initial"},"Idle":{"internalTransitions":{"receiveAskData":{"trigger":"askData"},"write":{"guard":"EP_IS_EMPTY(device)%20&&%20EP_IS_EMPTY(driver)","effect":"driver.write(this.value);"},"inc":{"guard":"EP_IS_EMPTY(device)%20&&%20this.value%20<%20255","effect":"this.value++;"},"dec":{"guard":"EP_IS_EMPTY(device)%20&&%20this.value%20>%200","effect":"this.value--;"}}}},"transitionByName":{"init2Idle":{"source":"init","target":"Idle","effect":"this.value%20=%200;"}}},{"name":"driver","stateByName":{"init":{"type":"Pseudostate","kind":"initial"},"choice1":{"type":"Pseudostate","kind":"choice"},"choice":{"type":"Pseudostate","kind":"choice"},"Idle":{"entry":"this.packetSize%20=%200;"}},"transitionByName":{"init2Idle":{"source":"init","target":"Idle","effect":"this.packetNumber%20=%200;"},"Idle2WaitSize":{"source":"Idle","target":"WaitSize","trigger":"after(10ms)","guard":"EP_IS_EMPTY(memoryBlock)%20&&%20!IS_IN_STATE(memoryBlock,%20memoryBlock.Error)","effect":"device.askData();"},"WaitSize2WaitPacketNumber":{"source":"WaitSize","target":"WaitPacketNumber","trigger":"write(byte)","effect":"memoryBlock.malloc(byte);%20this.offset%20=%200;"},"WaitPacketNumber2choice1":{"source":"WaitPacketNumber","target":"choice1","trigger":"write(byte)","guard":"EP_IS_EMPTY(memoryBlock)","effect":"\nthis.packetNumber%20=%20byte;"},"choice12Idle":{"source":"choice1","target":"Idle","guard":"else","effect":"\nconsole.log('process%20data');\nmemoryBlock.free();"},"choice12WaitPacketSize":{"source":"choice1","target":"WaitPacketSize","guard":"this.packetNumber%20>%200"},"WaitPacketSize2ReceiveData":{"source":"WaitPacketSize","target":"ReceiveData","trigger":"write(byte)","guard":"EP_IS_EMPTY(memoryBlock)","effect":"\nthis.packetSize%20=%20byte;"},"ReceiveData2choice":{"source":"ReceiveData","target":"choice","trigger":"write(byte)","guard":"EP_IS_EMPTY(memoryBlock)","effect":"\nmemoryBlock.set(offset,%20byte);\nthis.offset++;%20this.packetSize--;"},"choice2ReceiveData":{"source":"choice","target":"ReceiveData","guard":"this.packetSize%20>%200"},"choice2choice1":{"source":"choice","target":"choice1","guard":"else","effect":"\nthis.packetNumber--;"}}},{"name":"memoryBlock","stateByName":{"init":{"type":"Pseudostate","kind":"initial"},"choice":{"type":"Pseudostate","kind":"choice"},"Error":{"entry":"console.log('Error%20found!')","internalTransitions":{"malloc":{"trigger":"malloc"},"set":{"trigger":"set"},"free":{"trigger":"free"}}}},"transitionByName":{"init2Free":{"source":"init","target":"Free","effect":"this.size%20=%200;"},"Free2Allocated":{"source":"Free","target":"Allocated","trigger":"malloc(size)","effect":"this.size%20=%20size;"},"Free2Error":{"source":"Free","target":"Error","trigger":"set(offset,%20value)","effect":"this.errorMessage%20=%20'use%20after%20free%20(or%20without%20allocating)';"},"Allocated2Free":{"source":"Allocated","target":"Free","trigger":"free()","effect":"this.size%20=%200;"},"Allocated2choice":{"source":"Allocated","target":"choice","trigger":"set(offset,%20value)"},"choice2Allocated":{"source":"choice","target":"Allocated","guard":"offset%20>=%200%20&&%20offset%20<%20size"},"choice2Error":{"source":"choice","target":"Error","guard":"else","effect":"this.errorMessage%20=%20'out%20of%20bounds%20write';"}}}],"connectorByName":{"C1":{"ends":["device","driver"],"possibleMessages":{"forward":["write"],"reverse":["askData"]}},"C2":{"ends":["driver","memoryBlock"],"possibleMessages":{"forward":["malloc","set","free"]}}},"settings":{"semantics":{"keepOneMessagePerTrigger":false,"fireInitialTransitions":true,"autoFireAfterChoice":true,"reactiveSystem":true,"enableEventPools":true,"matchFirst":true,"checkEvents":true},"defaultToolValues":{"VERIFY_LTL_PROPERTY.property":"prop%20=%20[]%20!%20|IS_IN_STATE(memoryBlock,%20memoryBlock.Error)|","VERIFY_LTL_SAFETY_PROPERTY.property":"prop%20=%20[]%20!%20|IS_IN_STATE(memoryBlock,%20memoryBlock.Error)|"}}}) that can generate all possible byte sequences

Each model is expressed in [JSON](https://en.wikipedia.org/wiki/JSON) as part of an hyperlink to a public AnimUML server, and can be opened by clicking on its hyperlink.
Once opened in AnimUML, each model can be animated, and exported to: PlantUML, pretty-printed AnimUML JSON, or [tUML](http://ceur-ws.org/Vol-1285/paper08.pdf).
These models can also be used with other AnimUML servers installed from the [AnimUML repository](https://github.com/fjouault/AnimUML) by modifying the host part of their respective hyperlinks.

They have been presented in the following research paper:
```bibtex
@inproceedings{PasquierSecureMDE2020,
	title = {{Tool Support for Embedded Operating System Security: an Experience Feedback}},
	author = {Matthias Pasquier and Fr{\'{e}}d{\'{e}}ric Jouault and Matthias Brun and Julien P{\'{e}}rochon},
	booktitle = {Proceedings of the Second International Workshop on Security for and by Model-Driven Engineering (SecureMDE '20)},
	address   = {Montreal, Canada},
	month = oct,
	year = 2020,
	note = {To appear},
}
```
